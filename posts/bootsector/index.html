<!doctype html>
<html lang="en">
  <head>
    <title>BootSector // GetToKnow</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.110.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Taha Ed-dafili" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/gettoknow.github.io/css/main.min.145b13fd48627bdc1084ecf55c09b745e980bf92bccb5d509c71ab9dad6358d6.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BootSector"/>
<meta name="twitter:description" content="are you my 512 byte ? nah nah where are you my 0xAA55 ? BIOS And The Boot Sector: =&gt; The Proccess: You&#39;ve learned in previous chapters, The one taking control over the computer at the start up is the BIOS, after it&#39;s checks (POST) it will try to load an operating system, It&#39;s will look at the first 512 bye of each drive, the 512 byte of data called a sector, it&#39;s will be bootable if it finds at the end of that 512 byte the bytes 0x55 0xAA, which are the magic number for a boot sector, than it will load that 512 byte and hand the control to it starting to execute the instructions inside, here where we should put the code to load more memory, change the mode from real mode to protected mode and so on."/>

    <meta property="og:title" content="BootSector" />
<meta property="og:description" content="are you my 512 byte ? nah nah where are you my 0xAA55 ? BIOS And The Boot Sector: =&gt; The Proccess: You&#39;ve learned in previous chapters, The one taking control over the computer at the start up is the BIOS, after it&#39;s checks (POST) it will try to load an operating system, It&#39;s will look at the first 512 bye of each drive, the 512 byte of data called a sector, it&#39;s will be bootable if it finds at the end of that 512 byte the bytes 0x55 0xAA, which are the magic number for a boot sector, than it will load that 512 byte and hand the control to it starting to execute the instructions inside, here where we should put the code to load more memory, change the mode from real mode to protected mode and so on." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ayg0.github.io/gettoknow.github.io/posts/bootsector/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-01T18:41:24+01:00" />
<meta property="article:modified_time" content="2023-02-01T18:41:24+01:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://ayg0.github.io/gettoknow.github.io/"><img class="app-header-avatar" src="/gettoknow.github.io/ProgrammerHood.jpeg" alt="Taha Ed-dafili" /></a>
      <span class="app-header-title">GetToKnow</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/gettoknow.github.io/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/gettoknow.github.io/tags/">Tags</a>
             - 
          
          <a class="app-header-menu-item" href="/gettoknow.github.io/about/">About</a>
      </nav>
      <p>Enjoy your tour, as it&#39;s will be an interesting one.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/Ayg0" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.linkedin.com/in/taha-ed-dafili-a17779213/" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>linkedin</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">BootSector</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Feb 1, 2023
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span>	are you my <span style="color:#ae81ff">512</span> byte <span style="color:#f92672">?</span> nah nah where are you my  <span style="color:#ae81ff">0xAA55</span> <span style="color:#f92672">?</span>
</span></span></code></pre></div><h1 id="bios-and-the-boot-sector">BIOS And The Boot Sector:</h1>
<h3 id="-the-proccess"><code>=&gt; The Proccess:</code></h3>
<pre tabindex="0"><code>	You&#39;ve learned in previous chapters, The one taking control over the computer at the start up is the BIOS, after it&#39;s checks (POST) it will try to load an operating system, It&#39;s will look at the first 512 bye of each drive, the 512 byte of data called a sector, it&#39;s will be bootable if it finds at the end of that 512 byte the bytes 0x55 0xAA, which are the magic number for a boot sector, than it will load that 512 byte and hand the control to it starting to execute the instructions inside, here where we should put the code to load more memory, change the mode from real mode to protected mode and so on.
</code></pre><h3 id="-the-bare-minimum"><code>=&gt; The Bare Minimum:</code></h3>
<pre tabindex="0"><code>	let&#39;s start with the bare minimum to have a bootable device:
		- 512 byte;
		- end with the magic number 0x55AA;
	so when we view our boot.bin whith hexdump for example, should look something like this:
	
	 e9 fd ff 00 00 00 00 00 00 00 00 00 00 00 00 00
	 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
	 *
	 00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 aa
	
	for that we may write it ourselves (the dump way) or we can embrace the power of assembly and start coding.
</code></pre><h3 id="-bootasm"><code>=&gt; Boot.asm:</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span>	loop:			
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">jmp</span> <span style="color:#66d9ef">loop</span> <span style="color:#75715e">; creating an infinite loop so the cpu will not execute something we didn&#39;t wrote
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">times</span> <span style="color:#ae81ff">510</span>-(<span style="color:#66d9ef">$-$$</span>) <span style="color:#66d9ef">db</span> <span style="color:#ae81ff">0</span> <span style="color:#75715e">; sets a block of memory with the value 0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>						  <span style="color:#75715e">; $ is the current location counter (the address of the next instruction to be executed).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>						  <span style="color:#75715e">; $$ is the location counter for the beginning of the current section ( beginning of the sector).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>						  <span style="color:#75715e">; substructing ($ - $$) from 510 will give us how many byte we still need to fill with 0 to have 510 byte of memory.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">dw</span> <span style="color:#ae81ff">0xaa55</span>			  <span style="color:#75715e">; adding 0xaa55 will be the magic number and add 2 more byte so we have a full 512 byte of memory that ends with it.
</span></span></span></code></pre></div><h3 id="-building-and-testing"><code>=&gt; Building And Testing:</code></h3>
<pre tabindex="0"><code>	To test if our little code works we will need QEMU and NASM:
	
 Let&#39;s start with compiling our code using:
	$&gt; nasm -f bin boot.asm -o boot.bin

 And run it using:
	$&gt; qemu-system-x86_64 boot.bin

 If we did everything correctly QEMU should output this:
</code></pre><p><img src="/gettoknow.github.io/s_BS.png" alt="QEMU"></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
